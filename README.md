# Cache Sticky 📝

ブラウザのCache API動作を可視化するための、インタラクティブな付箋（ふせん）機能を持つミニマルなWebアプリケーションです。

## 🎯 目的

Cache Stickyは、ブラウザのCache APIの動作を学習するための教育ツールです。持続的な付箋を作成することで、以下のことが体験できます：

- 無制限の付箋作成（各付箋最大200文字）
- ページ更新後もCache APIによる付箋の永続化を確認
- ブラウザキャッシュクリア時の付箋消失の観察
- ブラウザストレージの制限と動作の学習

## ✨ 機能

- **📝 インタラクティブな付箋**: テキスト付箋の作成、編集、保存
- **🔄 キャッシュ永続化**: ブラウザCache APIによる付箋の永続化
- **🎨 統一されたふせんUI**: 説明、ボタン、ユーザー付箋すべてがふせん形式
- **📐 グリッド配置システム**: 重複しない整然とした配置
- **📱 レスポンシブデザイン**: デスクトップとモバイルデバイス対応
- **🔒 クライアントサイドのみ**: バックエンド不要、純粋なフロントエンドアプリケーション
- **⚡ 高速パフォーマンス**: 多数の付箋でもスムーズな操作
- **🧪 教育的価値**: Cache API概念の学習に最適

## 🚀 クイックスタート

### 前提条件

- Node.js 18+ および npm
- Cache API対応のモダンブラウザ：
  - Chrome 40+
  - Firefox 41+
  - Safari 11.1+
  - Edge 79+

### インストール・セットアップ

```bash
# リポジトリをクローン
git clone https://github.com/your-username/cache_sticky.git
cd cache_sticky

# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev

# ブラウザで http://localhost:5173 を開く
```

### プロダクションビルド

```bash
# プロダクション用にビルド
npm run build

# プロダクションビルドをプレビュー
npm run preview
```

## 📚 使い方

### 基本的な使用方法

1. **付箋を作成**: 「＋新しいふせん」のふせん型ボタンをクリック
2. **内容を記入**: メッセージを入力（最大200文字）
3. **保存**: Enterキーを押すか、外側をクリック
4. **永続化をテスト**: ページを更新しても付箋が再表示されることを確認
5. **キャッシュクリア**: ブラウザ開発者ツールでキャッシュをクリアして付箋が消えることを確認

### UI設計

- **統一されたふせんUI**: 使い方説明、新しいふせんボタン、ユーザー作成ふせんすべてが同じふせん形式
- **グリッド配置**: 200px×150pxのグリッドで整然と配置
- **固定エリア**:
  - 第1行: 使い方説明ふせん（3個）
  - 第2行: 新しいふせんボタン（左端）
  - 第3行以降: ユーザー作成ふせん

### キーボードショートカット

- **Enter**: 現在の付箋を保存
- **Escape**: 付箋の作成・編集をキャンセル
- **Tab**: UI要素間の移動

### Cache APIデモンストレーション

Cache APIの動作を確認するには：

1. 異なる内容で複数の付箋を作成
2. ページを更新して付箋が維持されることを確認
3. 開発者ツール（F12）を開く
4. Application/Storage → Cache Storage に移動
5. キャッシュエントリを削除するか、全ての閲覧データをクリア
6. ページを更新 - すべての付箋が消失

## 🛠️ 開発

### プロジェクト構造

```
cache_sticky/
├── src/
│   ├── components/     # UIコンポーネント（StickyNote、Whiteboardなど）
│   ├── models/         # データモデルとバリデーション
│   ├── services/       # ビジネスロジック（CacheService、WhiteboardService）
│   ├── styles/         # CSSスタイル
│   ├── types/          # TypeScript型定義
│   └── main.ts         # アプリケーションエントリーポイント
├── tests/
│   ├── contract/       # コントラクト・インターフェーステスト
│   ├── integration/    # 統合テスト
│   ├── unit/           # ユニットテスト
│   └── e2e/            # エンドツーエンドテスト（Playwright）
├── public/             # 静的アセット
└── specs/              # 機能仕様書とドキュメント
```

### 利用可能なスクリプト

```bash
# 開発
npm run dev          # 開発サーバーを起動
npm run build        # プロダクション用ビルド
npm run preview      # プロダクションビルドのプレビュー

# テスト
npm run test         # ユニットテスト（Jest）
npm run test:e2e     # エンドツーエンドテスト（Playwright）
npm run test:coverage # テストカバレッジレポート生成

# コード品質
npm run lint         # コード品質チェック（ESLint）
npm run format       # コードフォーマット（Prettier）
npm run type-check   # TypeScriptバリデーション
```

### 技術スタック

- **フレームワーク**: Vanilla TypeScript + Vite
- **ストレージ**: Browser Cache API
- **テスト**: Jest（ユニット） + Playwright（e2e）
- **コード品質**: ESLint + Prettier
- **ビルドツール**: Vite
- **スタイリング**: レスポンシブデザイン対応CSS3

## 🧪 テスト

プロジェクトはTest-Driven Development（TDD）に従い、90%以上のテストカバレッジを維持しています：

### テスト実行

```bash
# 全ユニットテストを実行
npm run test

# カバレッジ付きでテスト実行
npm run test:coverage

# エンドツーエンドテストを実行
npm run test:e2e

# 特定のテストファイルを実行
npm run test tests/contract/test_cache_service.test.ts
```

### テストカテゴリ

- **コントラクトテスト**: サービスインターフェースの期待動作を検証
- **統合テスト**: コンポーネント間の相互作用とユーザーフローをテスト
- **エンドツーエンドテスト**: 完全なブラウザ自動化テスト
- **ユニットテスト**: 個別の関数やクラスのテスト

## 🎓 学習目標

Cache Stickyを使用することで、以下の理解が深まります：

### Cache API基礎
- Cache APIとlocalStorage/sessionStorageの違い
- データ保存におけるRequest/Responseパターン
- キャッシュキーの管理と取得
- ブラウザ制御によるキャッシュクリア動作

### フロントエンドアーキテクチャ
- TypeScriptインターフェース設計と実装
- ビジネスロジックのサービス層パターン
- コンポーネントベースUIアーキテクチャ
- エラーハンドリングとユーザーフィードバック

### パフォーマンス考慮事項
- 無制限データでのメモリ管理
- 効率的なDOM操作
- ブラウザ互換性戦略
- プログレッシブエンハンスメント

## 📖 アーキテクチャと設計

### コアサービス

- **CacheService**: すべてのCache API操作を処理
- **WhiteboardService**: 付箋の作成、バリデーション、グリッド配置ロジックを管理
- **StickyNoteComponent**: 個別付箋のUI管理
- **Whiteboard**: メインアプリケーションの統制、固定ふせん（説明・ボタン）の管理

### 設計パターン

- **サービス層**: UIからビジネスロジックの分離
- **コンポーネントパターン**: 再利用可能なUIコンポーネント
- **オブザーバーパターン**: イベント駆動型相互作用
- **エラーバウンダリ**: 優雅なエラーハンドリング

### セキュリティ機能

- **入力サニタイゼーション**: 付箋内容のXSS防止
- **コンテンツセキュリティポリシー**: スクリプト実行の制限
- **型安全性**: 実行時安全性のためのTypeScript
- **バリデーション**: クライアントサイド入力検証

## 🔧 設定

### ブラウザ互換性

アプリケーションは自動的にCache APIの利用可能性を検出し、フォールバック動作を提供します：

- **Cache利用可能**: 永続化機能付きの完全な機能
- **Cache利用不可**: 警告付きのメモリのみモード

### パフォーマンス設定

- **文字制限**: 付箋あたり200文字（設定可能）
- **配置管理**: 重複を防ぐ自動付箋配置
- **メモリクリーンアップ**: 適切なイベントリスナークリーンアップ

## 🤝 貢献

1. リポジトリをフォーク
2. 機能ブランチを作成（`git checkout -b feature/amazing-feature`）
3. 既存のコードスタイルに従って変更を実行
4. 新機能にテストを追加
5. すべてのテストが通ることを確認（`npm run test`）
6. リンティングを実行（`npm run lint`）
7. 変更をコミット（`git commit -m 'Add amazing feature'`）
8. ブランチにプッシュ（`git push origin feature/amazing-feature`）
9. プルリクエストを開く

### 開発ガイドライン

- TypeScript strict modeに従う
- 90%以上のテストカバレッジを維持
- 新機能にTDDアプローチを使用
- 既存の命名規則に従う
- パブリックAPIにJSDocコメントを追加

## 📝 ライセンス

このプロジェクトはMITライセンスの下でライセンスされています - 詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 🙏 謝辞

- 教育目的のために❤️で構築
- ブラウザストレージAPIを理解する必要性にインスパイア
- Cache APIドキュメントのためのWeb開発コミュニティに感謝

## 🐛 既知の問題と制限

- すべてのブラウザでCache APIがサポートされているわけではない（優雅なフォールバック提供）
- キャッシュクォータ制限はブラウザと利用可能ストレージによって異なる
- 付箋はオリジンごと（ドメイン + プロトコル + ポート）に保存
- キャッシュクリアはブラウザによって制御され、アプリケーションではない

## 📞 サポート

問題が発生した場合や質問がある場合：

1. [GitHub Issues](https://github.com/your-username/cache_sticky/issues)を確認
2. エラーメッセージについてブラウザコンソールを確認
3. ブラウザがCache APIをサポートしていることを確認
4. ブラウザキャッシュをクリアして再読み込みを試行

---

**楽しいキャッシュライフを！** 🎉